<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>Using Amazon Fling with Android MediaRouter | Fling SDK</title>
    
    <base target="_self">
    <meta name="description" content="The MediaRouter framework in Android enables your app to direct the output of media playback to a specific device. The API included in the SDK provides a FlingMediaRouteProvider class... " />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" value="notranslate">
    <link rel="icon"  type="image/x-icon" href="favicon.ico">
<!--
    Licensed under the Apache License, Version 2.0 (the "License"). You may not use this file except in compliance with the License. A copy of the License is located at http://aws.amazon.com/apache2.0/ or in the "license" file accompanying this file. This file is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License. This site also includes third-party software subject to various copyrights. The licenses for these third party components are referenced in the NOTICE file.
-->

    <!-- FontAwesome -->
   <link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <!-- jQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.js"></script>
    <!-- Navgoco -->
    <script type="text/javascript" src="assets/js/jquery.navgoco.min.js"></script>
    <!-- Bootstrap -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <!-- TOC generator-->
    <script src="assets/js/toc.js"></script>
    <!-- Anchor JS -->
    
        <script src="assets/js/anchor.min.js"></script>
    

    <script>
        $( document ).ready(function() {
            $("#docnavsidebar").navgoco({
                caretHtml: '',
                accordion: false,
                openClass: 'open', // open
                save: true,
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 300,
                    easing: 'swing'
                }
            });
            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#docnavsidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#docnavsidebar").navgoco('toggle', true);
            });
        });

    </script>
    <script src="assets/js/customscripts.js"></script>

    <script>
        $(document).ready(function() {
            $('[data-toggle=offcanvas]').click(function() {
                $('.row-offcanvas').toggleClass('active');
            });
        });
    </script>


    <!--Bootstrap -->

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <style>
        ul#markdown-toc::before  {
        content: "Table of Contents"
         }
    </style>

</head>
<body class="default">
<div class="page-container">


    <!-- Top Navigation -->
    <nav class="navbar navbar-default navbar-fixed-top">
        <div class="container topnavlinks">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="fa fa-bars fa-2x"></span>
                </button>
                <button type="button" class="navbar-toggle toggle-sidebar-button"  data-toggle="offcanvas" data-target=".sidebar-nav">
                    <span class="sidebarToggle fa fa-columns fa-2x"></span>
                </button>

                <a class="navbar-brand noCrossRef" href="https://developer.amazon.com/">
                    <img class="navbar-logo" src="amazonlogowhite.png"/>
            </div>

            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-left">

                    <!-- single item nav items appear here -->

                    
                    
                    
                    
                    <li><a href="index.html">Documentation Home</a></li>
                    
                    
                    <li><a href="https://github.com/amzn/appstore-alexa-docs/issues" class="noCrossRef">Log Doc Issue</a></li>
                    <li><a target="_blank" href="https://github.com/amzn/appstore-alexa-docs/blob/github-docs/_docs/firetv/fling/using-amazon-fling-with-android-mediarouter.md" class="editButton noCrossRef"><i class="fa fa-github fa-lg"></i> Edit on GitHub</a></li>
                    
                    <li><a href="https://forums.developer.amazon.com/spaces/66/index.html" class="editButton noCrossRef">Fling SDK Forum</a></li>
                    
                    
                    

                    <!-- drop-down nav items appear here -->

                    


                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <!--start search -->
                        <!--
                        <div id="search-demo-container">
                            <form action="search.html" method="get">
                                <input type="text" id="search-input" placeholder="Global Search ..." name="query">
                            </form>
                        </div>
                        -->
                        <!-- end search-->
                    </li>
                </ul>
            </div>

        </div>


        <!-- /.container -->
    </nav>


<div class="container">
        <div class="row row-offcanvas row-offcanvas-left">

            <!-- sidebar -->
            <div class="col-xs-6 col-sm-3 sidebar-offcanvas" id="sidebar" role="navigation">

                


<div class="mydocsidebar">
<div class="sidebar-inner">
<!-- search bar - uses Lunr.js  -->

<div class="sidebarSearchBar">
<form action="search-fling.html" method="get">
  <div class="input-group search">
    <input type="text" id="search-box" name="query" class="form-control" placeholder="Product Search ...">
    <div class="input-group-btn">
      <button class="btn btn-default" type="submit" value="search">
        <i class="glyphicon glyphicon-search"></i>
      </button>
    </div>
  </div>
</form>
</div>

<!-- end search bar -->


<div class="productTitle">Fling SDK</div>
<p class="external">
    <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
</p>



    <ul id="docnavsidebar" class="docnav">
    
    <li class="level1"><a href="#">Fling Overview</a>
        <ul>
            

            
            
            <li class="level1items"><a href="understanding-the-amazon-fling-service.html">Understanding the Amazon Fling Service</a></li>
            
            

            

            

            
            
            <li class="level1items"><a  class="noCrossRef" href="https://developer.amazon.com/public/resources/development-tools/sdk">Download the Fling SDK</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="amazon-fling-frequently-asked-questions.html">Amazon Fling Frequently Asked Questions</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">Settting Up Fling</a>
        <ul>
            

            
            
            <li class="level1items"><a href="setting-up-your-amazon-fling-development-environment-for-android.html">Setting Up Your Amazon Fling Development Environment for Android</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="setting-up-your-amazon-fling-development-environment-for-ios.html">Setting Up your Amazon Fling Development Environment for iOS</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">Integrating Fling with Android, iOS, and Fire TV Apps</a>
        <ul>
            

            
            
            <li class="level1items"><a href="integrating-amazon-fling-into-your-android-app.html">Integrating Amazon Fling into Your Android App</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="integrating-amazon-fling-into-your-ios-app.html">Integrating Amazon Fling into your iOS App</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="integrating-amazon-fling-into-your-fire-tv-app.html">Integrating Amazon Fling SDK into your Fire TV App</a></li>
            
            

            

            

            
            
            <li class="level1items open"><a href="using-amazon-fling-with-android-mediarouter.html">Using Amazon Fling with Android MediaRouter</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="working-with-built-in-receiver-on-fire-tv.html">Working with the Built-in Receiver on the Fire TV Platform</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">Integrating Fling with Google Cast Apps</a>
        <ul>
            

            
            
            <li class="level1items"><a href="integrating-amazon-fling-with-cast.html">Integrating Amazon Fling with Apps that Use Google Cast</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="integrating-amazon-fling-with-an-existing-android-cast-app.html">Integrating Amazon Fling with an Existing Android App that Uses Google Cast</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="integrating-amazon-fling-with-an-existing-ios-cast-app.html">Integrating Amazon Fling with an Existing iOS App that uses Google Cast</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">Fling UX</a>
        <ul>
            

            
            
            <li class="level1items"><a href="designing-amazon-fling-ux.html">Designing Amazon Fling UX</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">Remote Install</a>
        <ul>
            

            
            
            <li class="level1items"><a href="remote-install.html">Remote Install</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="android-remote-install.html">Integrating Remote Install into Your Android App</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="ios-remote-install.html">Integrating Remote Install into Your iOS App</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">Unity Plugins</a>
        <ul>
            

            
            
            <li class="level1items"><a href="unity-controller-plugin.html">Integrating the Amazon Fling Controller In Your Games</a></li>
            
            

            

            

            
            
            <li class="level1items"><a href="unity-player-plugin.html">Integrating the Amazon Fling Player In Your Games</a></li>
            
            

            

            
        </ul>

        
    <li class="level1"><a href="#">API Docs</a>
        <ul>
            

            
            
            <li class="level1items"><a  class="noCrossRef" href="https://developer.amazon.com/public/binaries/content/assets/javadoc/whisperplay/javadocs/reference/packages.html">Android API Documentation</a></li>
            
            

            

            

            
            
            <li class="level1items"><a  class="noCrossRef" href="https://developer.amazon.com/public/binaries/content/assets/javadoc/whisperplay/objc-apidocs/index.html">iOS API Documentation</a></li>
            
            

            

            
        </ul>

        

    </li>
</ul>

<hr class="resourceSeparator"></hr>
<div class="relatedResources">Related Resources</div>
<ul id="entrypages">
        
        <li><a class="noCrossRef" href="/getting-started-developing-apps-and-games-for-amazon-fire-tv.html">Fire TV</a></li>
        
        <li><a class="noCrossRef" href="/fire-app-builder-overview.html">Fire App Builder</a></li>
        
        <li><a class="noCrossRef" href="/appstore-understanding-submission">Appstore Publishing</a></li>
        
        <li><a class="noCrossRef" href="/getting-started-with-iap">In-App Purchasing API</a></li>
        
        <li><a class="noCrossRef" href="/understanding-the-amazon-fling-service">Fling SDK</a></li>
        
        <li><a class="noCrossRef" href="">Developer Portal Forums</a></li>
        
    </li>
</ul>
</div>
</div>
<script>$("li.open").parents('li').toggleClass("open");</script>






            </div>

            <!-- main area -->
            <div class="col-xs-12 col-sm-9 main">

                    <div class="subtitle"><a href="http://developer.amazon.com" class="noCrossRef productSubtitle"> Home</a> > <a href="index.html" class="noCrossRef productSubtitle"> Documentation</a> > Fling SDK </div>

                    <h1>Using Amazon Fling with Android MediaRouter</h1>

                    <p>The <a href="https://developer.android.com/guide/topics/media/mediarouter.html">MediaRouter</a> framework in Android enables your app to direct the output of media playback to a specific device. The API included in the SDK provides a FlingMediaRouteProvider class for controller apps, which makes it easy to integrate this functionality into your MediaRouter-based app.</p>

<ul id="markdown-toc">
  <li><a href="#integrating-flingmediarouteprovider" id="markdown-toc-integrating-flingmediarouteprovider">Integrating FlingMediaRouteProvider</a></li>
  <li><a href="#discovering-media-devices-with-mediarouter" id="markdown-toc-discovering-media-devices-with-mediarouter">Discovering Media Devices With MediaRouter</a></li>
  <li><a href="#using-remoteplaybackclient-to-fling-content" id="markdown-toc-using-remoteplaybackclient-to-fling-content">Using RemotePlaybackClient To Fling Content</a></li>
  <li><a href="#using-sendcontrolrequest-to-fling-content" id="markdown-toc-using-sendcontrolrequest-to-fling-content">Using sendControlRequest() To Fling Content</a></li>
  <li><a href="#getting-status-updates" id="markdown-toc-getting-status-updates">Getting Status Updates</a></li>
</ul>

<h2 id="integrating-flingmediarouteprovider">Integrating FlingMediaRouteProvider</h2>

<p>The <code class="highlighter-rouge">FlingMediaRouteProvider</code> class can be integrated into your app by adding the following lines to your existing activity:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">com.amazon.whisperplay.fling.provider.FlingMediaRouteProvider</span><span class="o">;</span>
<span class="o">...</span>
    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="o">...</span>
        <span class="n">MediaRouter</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="k">this</span><span class="o">).</span><span class="na">addProvider</span><span class="o">(</span><span class="k">new</span> <span class="n">FlingMediaRouteProvider</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"acme.fling.player"</span><span class="o">));</span>
        <span class="o">...</span>
    <span class="o">}</span>
</code></pre>
</div>

<p>MediaRouter provides routes to Amazon Fire TV apps implementing the service ID you provide. Change the service ID in the example above (acme.fling.player) to the service ID of your Amazon Fire TV application. The <code class="highlighter-rouge">FlingMediaRouteProvider</code> class provides all of the functionality accessible through <a href="https://developer.android.com/reference/android/support/v7/media/RemotePlaybackClient.html"><code class="highlighter-rouge">RemotePlaybackClient</code>,</a> except queuing. Applications sending control intents directly to the route instead of using a <code class="highlighter-rouge">RemotePlaybackClient</code> support these standard <a href="https://developer.android.com/reference/android/support/v7/media/MediaControlIntent.html"><code class="highlighter-rouge">MediaControlIntent</code></a> intents:</p>

<ul>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_PLAY</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_SEEK</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_GET_STATUS</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_PAUSE</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_RESUME</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_STOP</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_START_SESSION</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_GET_SESSION_STATUS</code></li>
  <li><code class="highlighter-rouge">MediaControlIntent.ACTION_END_SESSION</code></li>
</ul>

<p>In addition, these intents provide additional functionality not provided by the default intents. More information on required intent extras and the extras returned from these intents can be found in the API documentation provided with the SDK (Javadocs).</p>

<ul>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_MUTE</code></li>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_UNMUTE</code></li>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_GET_IS_MUTE</code></li>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_GET_MEDIA_INFO</code></li>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_SEND_COMMAND</code></li>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_SET_PLAYER_STYLE</code></li>
  <li><code class="highlighter-rouge">FlingMediaControlIntent.ACTION_GET_IS_MIME_TYPE_SUPPORTED</code></li>
</ul>

<h2 id="discovering-media-devices-with-mediarouter">Discovering Media Devices With MediaRouter</h2>

<p>MediaRouter can be used to control device discovery on your controller app. Obtain a <code class="highlighter-rouge">MediaRouter</code> object with <code class="highlighter-rouge">getInstance()</code>:</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">private</span> <span class="n">MediaRouter</span> <span class="n">mMediaRouter</span><span class="o">;</span>
    <span class="o">...</span>
        <span class="n">mMediaRouter</span> <span class="o">=</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">getInstance</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
</code></pre>
</div>

<p>After you get an instance of <code class="highlighter-rouge">MediaRouter</code>, add the provider, as documented in the previous section. Then, create a <code class="highlighter-rouge">MediaRouteSelector</code> and a <code class="highlighter-rouge">MediaRouter.Callback</code> to handle discovering devices, and then add them to <code class="highlighter-rouge">MediaRouter</code>.</p>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> The <code class="highlighter-rouge">FlingMediaRouteProvider</code> only provides routes if you are using the control category <code class="highlighter-rouge">MediaControlIntent.CATEGORY_REMOTE_PLAYBACK</code> when creating your <code class="highlighter-rouge">MediaRouteSelector</code>. The code sample below uses the flag <code class="highlighter-rouge">MediaRouter.CALLBACK_FLAG_PERMFORM_ACTIVE_SCAN</code> to continuously look for devices while the callback is registered.</div>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">private</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">Callback</span> <span class="n">mMediaRouterCallback</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">Callback</span><span class="o">()</span> <span class="o">{</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onRouteAdded</span><span class="o">(</span><span class="n">MediaRouter</span> <span class="n">router</span><span class="o">,</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">RouteInfo</span> <span class="n">route</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//your code for handling when a new route is discovered here</span>
        <span class="o">}</span>

        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onRouteRemoved</span><span class="o">(</span><span class="n">MediaRouter</span> <span class="n">router</span><span class="o">,</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">RouteInfo</span> <span class="n">route</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//your code for handling when a route is no longer available</span>
        <span class="o">}</span>
    <span class="o">};</span>
    <span class="o">...</span>
        <span class="n">mMediaRouter</span><span class="o">.</span><span class="na">addProvider</span><span class="o">(</span><span class="k">new</span> <span class="n">FlingMediaRouteProvider</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="s">"acme.fling.player"</span><span class="o">));</span>
        <span class="n">MediaRouteSelector</span> <span class="n">mediaRouteSelector</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MediaRouteSelector</span><span class="o">.</span><span class="na">Builder</span><span class="o">()</span>
                <span class="o">.</span><span class="na">addControlCategory</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">CATEGORY_REMOTE_PLAYBACK</span><span class="o">)</span>
                <span class="o">.</span><span class="na">build</span><span class="o">();</span>
        <span class="n">mMediaRouter</span><span class="o">.</span><span class="na">addCallback</span><span class="o">(</span><span class="n">mediaRouteSelector</span><span class="o">,</span> <span class="n">mMediaRouterCallback</span><span class="o">,</span>
                <span class="n">MediaRouter</span><span class="o">.</span><span class="na">CALLBACK_FLAG_PERFORM_ACTIVE_SCAN</span><span class="o">);</span>
</code></pre>
</div>

<p>When device routes have been discovered your app can interact with those routes with a RemotePlaybackClient object, or with playback control requests.  Volume control is covered in the next section.</p>

<h2 id="using-remoteplaybackclient-to-fling-content">Using RemotePlaybackClient To Fling Content</h2>

<p>Initialize a <code class="highlighter-rouge">RemotePlaybackClient</code> object with the route provided by <code class="highlighter-rouge">MediaRouter</code>. In this example, the <code class="highlighter-rouge">mCurrentRoute</code> variable is a <code class="highlighter-rouge">MediaRouter.RouteInfo</code> instance provided by the <code class="highlighter-rouge">onRouteAdded()</code> method in your <code class="highlighter-rouge">MediaRouter.Callback</code>.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code>    <span class="kd">private</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">RouteInfo</span> <span class="n">mCurrentRoute</span><span class="o">;</span>
    <span class="kd">private</span> <span class="n">RemotePlaybackClient</span> <span class="n">mClient</span><span class="o">;</span>
    <span class="o">...</span>
        <span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">select</span><span class="o">();</span>
        <span class="n">mClient</span> <span class="o">=</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">(</span><span class="n">getApplicationContext</span><span class="o">(),</span> <span class="n">mCurrentRoute</span><span class="o">);</span>
</code></pre>
</div>

<p>Once the <code class="highlighter-rouge">RemotePlaybackClient</code> object is created your app can communicate with the remote device. Any calls to your remote device must include an asynchronous callback, which is called when the provider has received a response and has finished processing.</p>

<p>The callback provides some variables such as <code class="highlighter-rouge">sessionId</code>, and a <code class="highlighter-rouge">Bundle</code> with data. See the <a href="https://developer.android.com/reference/android/support/v7/media/RemotePlaybackClient.html"><code class="highlighter-rouge">RemotePlaybackClient</code></a> and <a href="https://developer.android.com/reference/android/support/v7/media/MediaControlIntent.html"><code class="highlighter-rouge">MediaControlIntent</code></a> classes for details on the data provided by each call and for additional methods.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">mClient</span><span class="o">.</span><span class="na">startSession</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">SessionActionCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResult</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">,</span> <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">MediaSessionStatus</span> <span class="n">sessionStatus</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//code handling a successful result here</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onError</span><span class="o">(</span><span class="n">String</span> <span class="n">error</span><span class="o">,</span> <span class="kt">int</span> <span class="n">code</span><span class="o">,</span> <span class="n">Bundle</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//code handling failure here</span>
    <span class="o">}</span>
<span class="o">});</span>

<span class="n">Uri</span> <span class="n">mUri</span> <span class="o">=</span> <span class="s">"http://www.leanbackplayer.com/videos/360p/elephants_dream_640x360_2.30.mp4"</span><span class="o">;</span>

<span class="c1">//build the metadata bundle that includes closed captioning information</span>
<span class="n">Bundle</span> <span class="n">metadataBundle</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bundle</span><span class="o">();</span>
<span class="n">metadataBundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">MediaItemMetadata</span><span class="o">.</span><span class="na">KEY_TITLE</span><span class="o">,</span> <span class="s">"Elephants Dream"</span><span class="o">);</span>
<span class="n">metadataBundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">MediaItemMetadata</span><span class="o">.</span><span class="na">KEY_ARTWORK_URI</span><span class="o">,</span> <span class="s">"http://en.wikipedia.org/wiki/Elephants_Dream#mediaviewer/File:Elephants_Dream_s5_both.jpg"</span><span class="o">);</span>
<span class="n">metadataBundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_TYPE</span><span class="o">,</span> <span class="s">"video/mp4"</span><span class="o">);</span>
<span class="n">metadataBundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_DESCRIPTION</span><span class="o">,</span> <span class="s">"Elephants Dream is the world?s first open movie, made entirely with open source graphics software such as Blender, and with all production files freely available to use however you please, under a Creative Commons license."</span><span class="o">);</span>
<span class="n">metadataBundle</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_NO_REPLAY</span><span class="o">,</span> <span class="s">"false"</span><span class="o">);</span>
<span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Bundle</span><span class="o">&gt;</span> <span class="n">ccTracks</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;&gt;();</span>
<span class="n">Bundle</span> <span class="n">track</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Bundle</span><span class="o">();</span>
<span class="n">track</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_TRACK_SOURCE</span><span class="o">,</span> <span class="s">"http://www.leanbackplayer.com/subtitles/elephants_dream/english_en.vtt"</span><span class="o">);</span>
<span class="n">track</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_TRACK_KIND</span><span class="o">,</span> <span class="s">"subtitles"</span><span class="o">);</span>
<span class="n">track</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_TRACK_SOURCE_LANGUAGE</span><span class="o">,</span> <span class="s">"en-US"</span><span class="o">);</span>
<span class="n">track</span><span class="o">.</span><span class="na">putString</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_TRACK_LABEL</span><span class="o">,</span> <span class="s">"English"</span><span class="o">);</span>
<span class="n">ccTracks</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">track</span><span class="o">);</span>  <span class="n">metadataBundle</span><span class="o">.</span><span class="na">putParcelableArrayList</span><span class="o">(</span><span class="n">FireTVBuiltInReceiverMetadata</span><span class="o">.</span><span class="na">KEY_TRACKS</span><span class="o">,</span> <span class="n">tracks</span><span class="o">);</span>

<span class="n">String</span> <span class="n">mItemID</span><span class="o">;</span>
<span class="n">mClient</span><span class="o">.</span><span class="na">play</span><span class="o">(</span><span class="n">mUri</span><span class="o">,</span> <span class="s">"video/mp4"</span><span class="o">,</span> <span class="n">metadataBundle</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">ItemActionCallback</span><span class="o">()</span> <span class="o">{</span>
	<span class="nd">@Override</span>
	<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResult</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">,</span> <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">MediaSessionStatus</span> <span class="n">sessionStatus</span><span class="o">,</span> <span class="n">String</span> <span class="n">itemId</span><span class="o">,</span> <span class="n">MediaItemStatus</span> <span class="n">itemStatus</span><span class="o">)</span> <span class="o">{</span>
		<span class="n">mItemID</span> <span class="o">=</span> <span class="n">itemId</span><span class="o">;</span>
	<span class="o">}</span>
<span class="o">});</span>

<span class="n">mClient</span><span class="o">.</span><span class="na">pause</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">SessionActionCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="n">mClient</span><span class="o">.</span><span class="na">resume</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">SessionActionCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="n">mClient</span><span class="o">.</span><span class="na">stop</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">SessionActionCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="c1">//seek to 10 seconds from the beginning</span>
<span class="kt">int</span> <span class="n">mPosition</span> <span class="o">=</span> <span class="mi">10000</span><span class="o">;</span>
<span class="n">mClient</span><span class="o">.</span><span class="na">seek</span><span class="o">(</span><span class="n">mItemID</span><span class="o">,</span> <span class="n">mPosition</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">ItemActionCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="n">mClient</span><span class="o">.</span><span class="na">endSession</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">SessionActionCallback</span><span class="o">()</span> <span class="o">{});</span>
</code></pre>
</div>

<h2 id="using-sendcontrolrequest-to-fling-content">Using sendControlRequest() To Fling Content</h2>

<p>Once you obtain a <code class="highlighter-rouge">MediaRouter.RouteInfo</code> object from <code class="highlighter-rouge">MediaRouter.Callback</code> you can call the <code class="highlighter-rouge">sendControlRequest()</code> method directly. To use this method, build an <code class="highlighter-rouge">Intent</code> for the command you wish to send, and include a <code class="highlighter-rouge">MediaRouter.ControlRequestCallback</code> object.</p>

<p>The callback is called when your request has received a response and has finished processing, and returns a <code class="highlighter-rouge">Bundle</code> containing the data you requested. The bundle data and additional actions not listed here are described at <a href="https://developer.android.com/reference/android/support/v7/media/MediaControlIntent.html"><code class="highlighter-rouge">MediaControlIntent</code></a>.</p>

<p>Implementing fling with the <code class="highlighter-rouge">sendControlRequest()</code> method requires more work than using <code class="highlighter-rouge">RemotePlaybackClient</code>, as it requires you to manage your session ID and create intents for every request.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">String</span> <span class="n">mSessionID</span><span class="o">;</span>
<span class="n">String</span> <span class="n">mItemID</span><span class="o">;</span>
<span class="c1">//Start Session</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_START_SESSION</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResult</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mSessionID</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//Play</span>
<span class="n">Uri</span> <span class="n">mUri</span> <span class="o">=</span> <span class="s">"http://distribution.bbb3d.renderfarming.net/video/mp4/bbb_sunflower_1080p_30fps_normal.mp4"</span><span class="o">;</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_PLAY</span><span class="o">).</span><span class="na">setDataAndType</span><span class="o">(</span><span class="n">mUri</span><span class="o">,</span> <span class="s">"video/mp4"</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResult</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">mSessionID</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">);</span>
        <span class="n">mItemID</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_ITEM_ID</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">});</span>
<span class="c1">//Pause</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_PAUSE</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="c1">//Resume</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_RESUME</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="c1">//Stop</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_STOP</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="c1">//Seek</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_SEEK</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_ITEM_ID</span><span class="o">,</span> <span class="n">mItemID</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_ITEM_CONTENT_POSITION</span><span class="o">,</span> <span class="mi">10000</span><span class="o">);</span> <span class="c1">//10 seconds into the video</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{});</span>
<span class="c1">//End Session</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_END_SESSION</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{});</span>
</code></pre>
</div>

<h2 id="getting-status-updates">Getting Status Updates</h2>

<p>Status updates from the <code class="highlighter-rouge">MediaRouter.RouteInfo</code> object can be obtained in two ways: from direct requests, or by setting up a listener. Direct requests work similarly to what was described in the previous section.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">getStatus</span><span class="o">(</span><span class="n">mItemID</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">ItemActionCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResult</span><span class="o">(</span><span class="kd">final</span> <span class="n">Bundle</span> <span class="n">data</span><span class="o">,</span> <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">MediaSessionStatus</span> <span class="n">sessionStatus</span><span class="o">,</span> <span class="n">String</span> <span class="n">itemId</span><span class="o">,</span> <span class="n">MediaItemStatus</span> <span class="n">itemStatus</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//handle status here</span>
    <span class="o">}</span>
<span class="o">});</span>

<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_GET_STATUS</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_SESSION_ID</span><span class="o">,</span> <span class="n">mSessionID</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_ITEM_ID</span><span class="o">,</span> <span class="n">mItemID</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onResult</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//get status from bundle and use it here</span>
    <span class="o">}</span>
<span class="o">});</span>
</code></pre>
</div>

<p>You can add a listener when starting the session or playing content when using <code class="highlighter-rouge">sendControlRequest()</code>. If you’re using <code class="highlighter-rouge">RemotePlaybackClient</code> the listener can be added with the <code class="highlighter-rouge">setStatusCallback()</code> method. Set the listener before the session is created or any play commands are issued.</p>

<div class="language-java highlighter-rouge"><pre class="highlight"><code><span class="c1">//using RemotePlaybackClient</span>
<span class="n">mClient</span><span class="o">.</span><span class="na">setStatusCallback</span><span class="o">(</span><span class="k">new</span> <span class="n">RemotePlaybackClient</span><span class="o">.</span><span class="na">StatusCallback</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onItemStatusChanged</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">,</span>
                <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">MediaSessionStatus</span> <span class="n">sessionStatus</span><span class="o">,</span>
                <span class="n">String</span> <span class="n">itemId</span><span class="o">,</span> <span class="n">MediaItemStatus</span> <span class="n">itemStatus</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//update status here</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSessionStatusChanged</span><span class="o">(</span><span class="n">Bundle</span> <span class="n">data</span><span class="o">,</span>
                <span class="n">String</span> <span class="n">sessionId</span><span class="o">,</span> <span class="n">MediaSessionStatus</span> <span class="n">sessionStatus</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//update status here</span>
    <span class="o">}</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onSessionChanged</span><span class="o">(</span><span class="n">String</span> <span class="n">sessionId</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//update status here</span>
    <span class="o">}</span>
<span class="o">});</span>

<span class="c1">//using sendControlRequest</span>
<span class="n">String</span> <span class="n">ACTION_RECEIVE_MEDIA_STATUS_UPDATE</span> <span class="o">=</span> <span class="s">"acme.fling.player.ACTION_RECEIVE_MEDIA_STATUS_UPDATE"</span><span class="o">;</span>
<span class="n">mSessionStatusUpdateIntent</span> <span class="o">=</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">getBroadcast</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">intent</span><span class="o">,</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">FLAG_UPDATE_CURRENT</span><span class="o">);</span>
<span class="n">mMediaStatusBroadcastReceiver</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BroadcastReceiver</span><span class="o">()</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onReceive</span><span class="o">(</span><span class="n">Context</span> <span class="n">context</span><span class="o">,</span> <span class="n">Intent</span> <span class="n">intent</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">//handle status update here</span>
    <span class="o">}</span>
<span class="o">};</span>
<span class="n">mMediaStatusBroadcastIntentFilter</span> <span class="o">=</span> <span class="k">new</span> <span class="n">IntentFilter</span><span class="o">(</span><span class="n">ACTION_RECEIVE_MEDIA_STATUS_UPDATE</span><span class="o">);</span>
<span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">ACTION_RECEIVE_MEDIA_STATUS_UPDATE</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">setComponent</span><span class="o">(</span><span class="n">getCallingActivity</span><span class="o">());</span>
<span class="n">mMediaStatusUpdateIntent</span> <span class="o">=</span> <span class="n">PendingIntent</span><span class="o">.</span><span class="na">getBroadcast</span><span class="o">(</span><span class="k">this</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">intent</span><span class="o">,</span><span class="n">PendingIntent</span><span class="o">.</span><span class="na">FLAG_UPDATE_CURRENT</span><span class="o">);</span>
<span class="o">...</span>
<span class="n">Intent</span> <span class="n">intent</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Intent</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">ACTION_START_SESSION</span><span class="o">);</span>
<span class="n">intent</span><span class="o">.</span><span class="na">putExtra</span><span class="o">(</span><span class="n">MediaControlIntent</span><span class="o">.</span><span class="na">EXTRA_ITEM_STATUS_UPDATE_RECEIVER</span><span class="o">,</span> <span class="n">mMediaStatusUpdateIntent</span><span class="o">);</span>
<span class="n">mCurrentRoute</span><span class="o">.</span><span class="na">sendControlRequest</span><span class="o">(</span><span class="n">intent</span><span class="o">,</span> <span class="k">new</span> <span class="n">MediaRouter</span><span class="o">.</span><span class="na">ControlRequestCallback</span><span class="o">()</span> <span class="o">{});</span>
</code></pre>
</div>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Note:</b> There is a bug in the <code class="highlighter-rouge">MediaRouteProvider</code> object used by Cast devices that causes <code class="highlighter-rouge">onItemStatusChanged()</code> in <code class="highlighter-rouge">RemotePlaybackClient.StatusCallback</code> to never be called due to a missing session ID. This method receives updates properly for <code class="highlighter-rouge">FlingMediaRouteProvider</code>. <code class="highlighter-rouge">FlingMediaRouteProvider</code> also triggers the item status update every time the media position changes (maximum 1 call per second), although this may not be the case for all <code class="highlighter-rouge">MediaRouteProvider</code> instances.</div>




            </div>
        </div><!--/.container-->


    </div><!--/.page-container-->
    
    <div class="footertop">
    <div class="container">
        <div class="col-md-6">
            <p></p>
        </div>
        <div class="col-md-6">
            <ul class="bottom_ul">
        </div>
    </div>
</div>

<footer>
    <div class="container">
        <div class="row">
            <div class="col-md-4 col-sm-6 footerleft ">
                <div class="logofooter"> About the Developer Portal</div>
                <p>The Amazon Developer Portal provides documentation for developers creating apps for the Amazon
                    appstore, including Alexa skills. Apps include streaming media apps, game apps, skills, and more. </p>

            </div>
            <div class="col-md-2 col-sm-6 paddingtop-bottom">
                <h6 class="heading7">Links</h6>
                <ul class="footer-ul">
                    <li><a class="noCrossRef" href="https://developer.amazon.com/"> Developer Portal</a></li>
                    <li><a class="noCrossRef" href="/index.html">Documentation Home</a></li>
                    <li class="noCrossRef"><a href="https://developer.amazon.com/support"> Support</a></li>
                    <li class="noCrossRef"><a href="https://aws.amazon.com/documentation/"> AWS docs</a></li>
                    <li class="noCrossRef"><a href="https://www.amazon.com/mobile-apps/b?ie=UTF8&node=2350149011"> Amazon Appstore</a></li>
                </ul>
            </div>

            <div class="col-md-3 col-sm-6 paddingtop-bottom">
                <h6 class="heading7">Amazon News</h6>
                <ul class="footer-ul">
                    <li class="noCrossRef"><a href="https://developer.amazon.com/blogs"> Blog</a></li>
                    <li class="noCrossRef"><a href="https://www.youtube.com/channel/UCT9ApARFgQJOeqD-ygmxnJQ"> YouTube</a></li>
                    <li class="noCrossRef"><a href="https://twitter.com/AmazonAppDev"> Twitter</a></li>
                    <li class="noCrossRef"><a href="http://phx.corporate-ir.net/phoenix.zhtml?p=irol-mediahome&c=176060"> Amazon Press Room</a></li>
                </ul>
            </div>

            <div class="col-md-3 col-sm-6 paddingtop-bottom">
                <h6 class="heading7">Forums</h6>
                <ul class="footer-ul">
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/23/index.html"> Alexa Skills Kit</a></li>
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/33/index.html"> Smart Home Skill API</a></li>
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/38/index.html"> Alexa Voice Service</a></li>
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/167/index.html"> Appstore</a></li>
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/12/index.html"> Underground</a></li>
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/166/index.html"> Fire Devices</a></li>
                    <li class="noCrossRef"><a href="https://forums.developer.amazon.com/spaces/61/index.html"> Dash</a></li>
                </ul>
            </div>
        </div>
    </div>
    </div>
</footer>
<!--subfooter start from here -->

<div class="copyright">
    <div class="container">
        <div class="col-md-12">
            <p>© 1996-2017, Amazon.com, Inc. or its affiliates</p>
        </div>
    </div>
</div>

    
    <!--scripts loaded here-->



</body>

</html>
